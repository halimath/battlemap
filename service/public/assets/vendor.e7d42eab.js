function x(n,e){return typeof n!="string"?n:(e||(e=document.body),e.querySelector(n))}function c(n){p(n.firstChild)}function p(n,e){for(;n&&n!==e;){let t=n;n=n.nextSibling,t.parentNode.removeChild(t)}}function O(n){return typeof n=="function"||Array.isArray(n)||n instanceof Element||T(n)}function m(n,e,t){t=t!=null?t:!0;const i=typeof n=="string"?x(n):n;B(i,e),t&&F(i)}function F(n){const e=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,new $);let t;for(;t=e.nextNode();)t.dispatchEvent(new CustomEvent("update",{bubbles:!1}))}class ${acceptNode(e){return e.nodeType===Node.ELEMENT_NODE&&e.nodeName.indexOf("-")>=0?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}}function B(n,e){if(Array.isArray(e)){c(n),e.forEach(t=>{const i=document.createDocumentFragment();m(i,t),n.appendChild(i)});return}if(typeof e=="string"){c(n),n.appendChild(document.createTextNode(e));return}if(e instanceof Element){c(n),n.appendChild(e);return}if(T(e)){e.updateElement(n);return}e(n)}function T(n){return typeof n=="object"&&"updateElement"in n}const M="{{wecco:",W="}}",A=/(\{\{wecco:\d+\}\})/;function H(n){return n.split(A).filter(e=>e.length>0)}function d(n){return!!n.match(A)}function u(n){return parseInt(n.substr(M.length))}function w(n){return M+n.toString()+W}const f=new WeakMap;class b{constructor(e,t){this.strings=e,this.data=t}get templateString(){return typeof this._templateString=="undefined"&&(this._templateString=V(this.strings)),this._templateString}get templateElement(){return typeof this._templateElement=="undefined"&&(this._templateElement=document.createElement("template"),this._templateElement.innerHTML=this.templateString,this._bindings=K(this._templateElement.content)),this._templateElement}get bindings(){return typeof this._bindings=="undefined"?[]:this._bindings}updateElement(e){if(f.has(e)){const t=f.get(e);if(t.strings===this.strings){t.data=this.data,y(t.bindings,this.data);return}}c(e),e.appendChild(this.templateElement.content.cloneNode(!0)),J(this.bindings,e),y(this.bindings,this.data),f.set(e,this)}}const R=/[a-z0-9-_@]+\s*=\s*$/i,U=/[a-z0-9-_@]+\s*=\s*'[^']*$/i,z=/[a-z0-9-_@]+\s*=\s*"[^"]*$/i;function V(n){let e="";return n.forEach((t,i)=>{e+=t,i<n.length-1&&(R.test(e)||U.test(e)||z.test(e)?e+=w(i):e+=`<!--${w(i)}-->`)}),e.trim()}const h="DOM inconsistency error";class g{constructor(e){this.nodeIndex=e}bind(e,t){t===this.nodeIndex&&this.bindNode(e)}bindNode(e){this.node=e}}class E extends g{constructor(e,t){super(e);this.dataIndex=t}applyData(e){const t=e[this.dataIndex];this.boundData!==t&&(this.applyChangedData(t),this.boundData=t)}}class N extends g{constructor(e,t){super(e);this.dataIndex=t}bindNode(e){super.bindNode(e),e.data="",this.endMarker=e,this.startMarker=e.parentNode.insertBefore(k(),e)}applyData(e){const t=e[this.dataIndex];this.boundData!==t&&(typeof t=="string"?this.applyText(t):Y(t)?this.applyIterable(t):O(t)?this.applyElementUpdate(t):this.applyText(String(t)))}applyIterable(e){const t=Array.from(e);if(Array.isArray(this.boundData)){const i=this.boundData;t.length<i.length?(p(i[t.length].startMarker,this.endMarker),this.boundData=i.slice(0,t.length)):t.length>i.length&&this.createBindingsFromIterable(t,i.length)}else this.clear(),this.boundData=[],this.createBindingsFromIterable(t);this.boundData.forEach(i=>i.applyData(t))}createBindingsFromIterable(e,t=0){for(let i=t;i<e.length;++i){const s=this.endMarker.parentNode.insertBefore(k(),this.endMarker),r=new N(this.nodeIndex,i);r.bind(s,this.nodeIndex),this.boundData.push(r)}}applyElementUpdate(e){if(e instanceof b&&this.boundData instanceof b&&e.templateString===this.boundData.templateString){this.boundData.data=e.data,y(this.boundData.bindings,e.data);return}this.clear();const t=document.createDocumentFragment();m(t,e,!1),this.endMarker.parentNode.insertBefore(t,this.endMarker),this.boundData=e}applyText(e){if(this.endMarker.previousSibling.nodeType===Node.TEXT_NODE){this.endMarker.previousSibling.data=e,this.boundData=e;return}this.clear(),this.node=this.endMarker.parentNode.insertBefore(document.createTextNode(e),this.endMarker),this.boundData=e}clear(){var e;const t=this.startMarker?this.startMarker.nextSibling:this.node.parentNode.firstChild;p(t,(e=this.endMarker)!==null&&e!==void 0?e:this.node)}}class G extends g{constructor(e,t,i,s){super(e);this.attributeName=t,this.valueInstructions=i,this.directives=s}bindNode(e){if(e.nodeType!==Node.ELEMENT_NODE)throw console.error(`Expected element to set attribute ${this.attributeName} but got ${e}`),h;this.element=e,super.bindNode(e)}applyData(e){let t=!1;const i=this.valueInstructions.map(s=>{if(typeof s=="string")return s;let r=e[s];return(typeof r=="undefined"||r===null)&&(t=!0),r}).join("");if(t&&this.directives.omitEmpty){this.element.removeAttribute(this.attributeName),this.boundAttributeValue=void 0;return}i!==this.boundAttributeValue&&(this.element.setAttribute(this.attributeName,i),this.boundAttributeValue=i)}}class X extends E{constructor(e,t,i){super(e,i);this.attributeName=t}bindNode(e){if(e.nodeType!==Node.ELEMENT_NODE)throw console.error(`Expected element to set attribute ${this.attributeName} but got ${e}`),h;this.element=e,super.bindNode(e)}applyChangedData(e){e?this.element.setAttribute(this.attributeName,this.attributeName):this.element.removeAttribute(this.attributeName)}}class j extends E{constructor(e,t,i,s){super(e,i);this.eventName=t,this.directives=s}bindNode(e){if(e.nodeType!==Node.ELEMENT_NODE)throw console.error(`Expected element to set attribute ${this.eventName} but got ${e}`),h;this.element=e,super.bindNode(e)}applyChangedData(e){this.boundListener&&this.element.removeEventListener(this.eventName,this.boundListener),this.boundListener=this.createListener(e),this.element.addEventListener(this.eventName,this.boundListener,this.directives)}createListener(e){return!this.directives.stopPropagation&&!this.directives.stopImmediatePropagation&&!this.directives.preventDefault?e:t=>{this.directives.stopPropagation&&t.stopPropagation(),this.directives.stopImmediatePropagation&&t.stopImmediatePropagation(),this.directives.preventDefault&&t.preventDefault(),"handleEvent"in e?e.handleEvent(t):e(t)}}}class Q extends E{constructor(e,t,i){super(e,i);this.propertyName=t}bindNode(e){if(e.nodeType!==Node.ELEMENT_NODE)throw console.error(`Expected element to set property ${this.propertyName} but got ${e}`),h;this.element=e,super.bindNode(e)}applyChangedData(e){this.element[this.propertyName]=e}}function y(n,e){n.forEach(t=>t.applyData(e))}function J(n,e){const t=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT,null);let i=-1,s;for(;s=t.nextNode();)i++,n.forEach(r=>r.bind(s,i))}function K(n){const e=[],t=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT,null);let i=-1,s;for(;s=t.nextNode();)if(i++,s.nodeType===Node.COMMENT_NODE){const r=s;d(r.data)&&e.push(new N(i,u(r.data)))}else if(s.nodeType===Node.ELEMENT_NODE){const r=s;for(let a of r.getAttributeNames()){const _=r.getAttribute(a),l=H(_);if(a.startsWith("?")){if(r.removeAttribute(a),l.length!==1||!d(l[0])){console.error(`Got syntax error using boolean attribute ${a}: Only single placeholder is allowed as value. Found at ${r}.`);continue}e.push(new X(i,a.substr(1),u(l[0])));continue}if(a.startsWith(".")){if(r.removeAttribute(a),l.length!==1||!d(l[0])){console.error(`Got syntax error using property ${a}: Only single placeholder is allowed as value. Found at ${r}.`);continue}e.push(new Q(i,a.substr(1),u(l[0])));continue}if(a.startsWith("@")){if(r.removeAttribute(a),l.length!==1||!d(l[0])){console.error(`Got syntax error using event listener ${a}: Only single placeholder is allowed as value. Found at ${r}.`);continue}const o={},[C,...L]=a.substr(1).split("+");L.forEach(D=>{switch(D.toLocaleLowerCase()){case"capture":o.capture=!0;break;case"passive":o.passive=!0;break;case"once":o.once=!0;break;case"stoppropagation":o.stopPropagation=!0;break;case"stopimmediatepropagation":o.stopImmediatePropagation=!0;break;case"preventdefault":o.preventDefault=!0;break;default:console.warn(`unrecognized event binding directive: "${D}"`)}}),e.push(new j(i,C,u(l[0]),o));continue}if(l.length===1&&!d(l[0]))continue;r.removeAttribute(a);const I=l.map(o=>d(o)?u(o):o),v={},[P,...S]=a.split("+");S.forEach(o=>{switch(o.toLocaleLowerCase()){case"omitempty":v.omitEmpty=!0;break;default:console.warn(`unrecognized attribute binding directive: "${o}"`)}}),e.push(new G(i,P,I,v))}}return e}function k(){return document.createComment("")}function Y(n){return Array.isArray(n)||!!(n&&n[Symbol.iterator])}function te(n,...e){return new b(n,e)}const Z={};function ne(n,e,t,i){return new q(n,e,t,x(i))}class q{constructor(e,t,i,s){this.updater=t,this.view=i,this.mountPoint=s;const r=e();if(r instanceof Promise){r.then(a=>{this.model=a,this.performUpdate()}).catch(console.error);return}this.model=r,this.performUpdate()}emit(e){const t=this.updater(this.model,e,this);if(ee(t)){t.then(i=>this.applyModel(i)).catch(console.error);return}this.applyModel(t)}applyModel(e){e!=Z&&(this.model=e,this.performUpdate())}performUpdate(){m(this.mountPoint,this.view(this.model,this))}}function ee(n){return n instanceof Promise}export{ne as a,te as h,m as u};
